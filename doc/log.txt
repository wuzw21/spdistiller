params_array: test
current_task: test
/data/wzw/wzw/BitDistiller-Q4_0
loading llm model /data/wzw/models/Meta-Llama-3-8B
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.10s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.12s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.11s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.10it/s]
model.hf_device_map: {'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 1, 'model.layers.6': 1, 'model.layers.7': 1, 'model.layers.8': 1, 'model.layers.9': 1, 'model.layers.10': 1, 'model.layers.11': 1, 'model.layers.12': 1, 'model.layers.13': 1, 'model.layers.14': 1, 'model.layers.15': 2, 'model.layers.16': 2, 'model.layers.17': 2, 'model.layers.18': 2, 'model.layers.19': 2, 'model.layers.20': 2, 'model.layers.21': 2, 'model.layers.22': 2, 'model.layers.23': 2, 'model.layers.24': 2, 'model.layers.25': 3, 'model.layers.26': 3, 'model.layers.27': 3, 'model.layers.28': 3, 'model.layers.29': 3, 'model.layers.30': 3, 'model.layers.31': 3, 'model.norm': 3, 'model.rotary_emb': 3, 'lm_head': 3}
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(128256, 4096)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear(in_features=4096, out_features=1024, bias=False)
          (v_proj): Linear(in_features=4096, out_features=1024, bias=False)
          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=14336, bias=False)
          (up_proj): Linear(in_features=4096, out_features=14336, bias=False)
          (down_proj): Linear(in_features=14336, out_features=4096, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((4096,), eps=1e-05)
        (post_attention_layernorm): LlamaRMSNorm((4096,), eps=1e-05)
      )
    )
    (norm): LlamaRMSNorm((4096,), eps=1e-05)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=4096, out_features=128256, bias=False)
)
begin model sparse hook setting...
Create and load preditor...
Local device: cuda:0
Init Reset
num_layers 32
weight_counters {0: 7, 1: 7, 2: 7, 3: 7, 4: 7, 5: 7, 6: 7, 7: 7, 8: 7, 9: 7, 10: 7, 11: 7, 12: 7, 13: 7, 14: 7, 15: 7, 16: 7, 17: 7, 18: 7, 19: 7, 20: 7, 21: 7, 22: 7, 23: 7, 24: 7, 25: 7, 26: 7, 27: 7, 28: 7, 29: 7, 30: 7, 31: 7}
Init Reset
Filtered model elements weight-name / weight-id
weight_id 0 weight_name:  model.layers.0.self_attn.q_proj
weight_id 1 weight_name:  model.layers.0.self_attn.k_proj
weight_id 2 weight_name:  model.layers.0.self_attn.v_proj
weight_id 3 weight_name:  model.layers.0.self_attn.o_proj
weight_id 4 weight_name:  model.layers.0.mlp.gate_proj
weight_id 5 weight_name:  model.layers.0.mlp.up_proj
weight_id 6 weight_name:  model.layers.0.mlp.down_proj
Quantizing:   0%|          | 0/32 [00:00<?, ?it/s]Quantizing:   3%|▎         | 1/32 [00:00<00:04,  7.64it/s]Quantizing:  78%|███████▊  | 25/32 [00:00<00:00, 125.60it/s]Quantizing: 100%|██████████| 32/32 [00:00<00:00, 116.43it/s]
2025-03-31:17:27:21,034 WARNING  [huggingface.py:122] `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
2025-03-31:17:27:21,851 WARNING  [huggingface.py:329] Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
2025-03-31:17:27:21,853 INFO     [evaluator.py:152] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2025-03-31:17:27:21,853 INFO     [evaluator.py:203] Using pre-initialized model
2025-03-31:17:27:36,663 WARNING  [evaluator.py:251] Overwriting default num_fewshot of gsm8k from 5 to 3
2025-03-31:17:27:36,663 INFO     [evaluator.py:261] Setting fewshot random generator seed to 1234
2025-03-31:17:27:36,665 INFO     [task.py:411] Building contexts for gsm8k on rank 0...
task: eval
task_name: ['mmlu']
task_list ['gsm8k']
sp_configs:  [(0.5, 0.5, 0.0, 0)]
begin : sp_config:  (0.5, 0.5, 0.0, 0) num_shot:  3
Init Reset
Set sparsity: attn 0.5, mlp 0.5, w 0.0
Set pre-prediction: 0
set_sparsity_threshold
threshold_path /data/wzw/wzw/BitDistiller-Q4_0/data/threshold/Meta-Llama-3-8B/sparse-0.5.json
sparsity_strategy :  Static
sparsity_strategy:  Static
  0%|          | 0/300 [00:00<?, ?it/s] 11%|█         | 33/300 [00:00<00:00, 324.49it/s] 22%|██▏       | 66/300 [00:00<00:00, 327.12it/s] 33%|███▎      | 100/300 [00:00<00:00, 329.32it/s] 45%|████▍     | 134/300 [00:00<00:00, 330.33it/s] 56%|█████▌    | 168/300 [00:00<00:00, 330.06it/s] 67%|██████▋   | 202/300 [00:00<00:00, 331.09it/s] 79%|███████▊  | 236/300 [00:00<00:00, 332.24it/s] 90%|█████████ | 270/300 [00:00<00:00, 333.24it/s]100%|██████████| 300/300 [00:00<00:00, 331.30it/s]
2025-03-31:17:27:37,579 INFO     [evaluator.py:438] Running generate_until requests
Running generate_until requests:   0%|          | 0/300 [00:00<?, ?it/s]/home/donglinbai/miniconda3/envs/sparse/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/donglinbai/miniconda3/envs/sparse/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Running generate_until requests:   0%|          | 1/300 [00:10<52:58, 10.63s/it]Running generate_until requests:   1%|          | 2/300 [00:24<1:01:20, 12.35s/it]Running generate_until requests:   1%|          | 3/300 [00:30<47:13,  9.54s/it]  Running generate_until requests:   1%|▏         | 4/300 [00:41<50:40, 10.27s/it]Running generate_until requests:   2%|▏         | 5/300 [00:47<42:54,  8.73s/it]Running generate_until requests:   2%|▏         | 6/300 [00:57<43:44,  8.93s/it]Running generate_until requests:   2%|▏         | 7/300 [01:02<37:48,  7.74s/it]Running generate_until requests:   3%|▎         | 8/300 [01:12<40:45,  8.38s/it]Running generate_until requests:   3%|▎         | 9/300 [01:20<41:18,  8.52s/it]Running generate_until requests:   3%|▎         | 10/300 [01:26<37:05,  7.68s/it]Running generate_until requests:   4%|▎         | 11/300 [01:34<36:28,  7.57s/it]Running generate_until requests:   4%|▍         | 12/300 [01:45<42:21,  8.82s/it]Running generate_until requests:   4%|▍         | 13/300 [01:55<43:11,  9.03s/it]Running generate_until requests:   5%|▍         | 14/300 [02:01<39:07,  8.21s/it]Running generate_until requests:   5%|▌         | 15/300 [02:10<40:02,  8.43s/it]Running generate_until requests:   5%|▌         | 16/300 [02:14<33:17,  7.03s/it]Running generate_until requests:   6%|▌         | 17/300 [02:20<32:06,  6.81s/it]Running generate_until requests:   6%|▌         | 18/300 [02:33<39:57,  8.50s/it]Running generate_until requests:   6%|▋         | 19/300 [02:45<45:11,  9.65s/it]Running generate_until requests:   7%|▋         | 20/300 [02:48<36:29,  7.82s/it]Running generate_until requests:   7%|▋         | 21/300 [02:50<27:48,  5.98s/it]Running generate_until requests:   7%|▋         | 22/300 [03:01<35:08,  7.59s/it]Running generate_until requests:   8%|▊         | 23/300 [03:04<28:39,  6.21s/it]Running generate_until requests:   8%|▊         | 24/300 [03:24<47:08, 10.25s/it]Running generate_until requests:   8%|▊         | 25/300 [03:34<47:07, 10.28s/it]Running generate_until requests:   9%|▊         | 26/300 [03:41<41:57,  9.19s/it]Running generate_until requests:   9%|▉         | 27/300 [03:44<33:25,  7.35s/it]Running generate_until requests:   9%|▉         | 28/300 [04:00<45:05,  9.95s/it]Running generate_until requests:  10%|▉         | 29/300 [04:13<49:02, 10.86s/it]Running generate_until requests:  10%|█         | 30/300 [04:18<41:22,  9.20s/it]Running generate_until requests:  10%|█         | 31/300 [04:25<37:42,  8.41s/it]Running generate_until requests:  11%|█         | 32/300 [04:38<43:50,  9.81s/it]Running generate_until requests:  11%|█         | 33/300 [04:58<56:51, 12.78s/it]Running generate_until requests:  11%|█▏        | 34/300 [05:04<47:46, 10.78s/it]Running generate_until requests:  12%|█▏        | 35/300 [05:06<36:33,  8.28s/it]Running generate_until requests:  12%|█▏        | 36/300 [05:18<40:19,  9.17s/it]Running generate_until requests:  12%|█▏        | 37/300 [05:26<38:32,  8.79s/it]Running generate_until requests:  13%|█▎        | 38/300 [05:36<40:57,  9.38s/it]Running generate_until requests:  13%|█▎        | 39/300 [05:40<33:44,  7.76s/it]Running generate_until requests:  13%|█▎        | 40/300 [05:52<38:08,  8.80s/it]Running generate_until requests:  14%|█▎        | 41/300 [05:57<34:13,  7.93s/it]Running generate_until requests:  14%|█▍        | 42/300 [06:06<34:34,  8.04s/it]Running generate_until requests:  14%|█▍        | 43/300 [06:14<34:20,  8.02s/it]Running generate_until requests:  15%|█▍        | 44/300 [06:25<38:42,  9.07s/it]Running generate_until requests:  15%|█▌        | 45/300 [06:31<34:33,  8.13s/it]Running generate_until requests:  15%|█▌        | 46/300 [06:39<34:20,  8.11s/it]Running generate_until requests:  16%|█▌        | 47/300 [06:47<33:52,  8.03s/it]Running generate_until requests:  16%|█▌        | 48/300 [06:50<26:44,  6.37s/it]Running generate_until requests:  16%|█▋        | 49/300 [06:55<25:17,  6.05s/it]Running generate_until requests:  17%|█▋        | 50/300 [07:46<1:21:18, 19.51s/it]Running generate_until requests:  17%|█▋        | 51/300 [08:14<1:31:47, 22.12s/it]Running generate_until requests:  17%|█▋        | 52/300 [08:48<1:46:18, 25.72s/it]Running generate_until requests:  18%|█▊        | 53/300 [09:02<1:31:45, 22.29s/it]Running generate_until requests:  18%|█▊        | 54/300 [09:46<1:57:35, 28.68s/it]Running generate_until requests:  18%|█▊        | 55/300 [10:15<1:57:40, 28.82s/it]Running generate_until requests:  19%|█▊        | 56/300 [10:30<1:40:10, 24.63s/it]Running generate_until requests:  19%|█▉        | 57/300 [10:43<1:25:55, 21.22s/it]Running generate_until requests:  19%|█▉        | 58/300 [10:45<1:02:08, 15.41s/it]Running generate_until requests:  20%|█▉        | 59/300 [10:53<52:33, 13.09s/it]  Running generate_until requests:  20%|██        | 60/300 [10:59<44:05, 11.02s/it]Running generate_until requests:  20%|██        | 61/300 [11:18<54:03, 13.57s/it]Running generate_until requests:  21%|██        | 62/300 [11:23<42:44, 10.78s/it]Running generate_until requests:  21%|██        | 63/300 [11:42<52:53, 13.39s/it]Running generate_until requests:  21%|██▏       | 64/300 [11:46<40:58, 10.42s/it]Running generate_until requests:  22%|██▏       | 65/300 [11:54<38:40,  9.87s/it]Running generate_until requests:  22%|██▏       | 66/300 [11:57<30:40,  7.86s/it]Running generate_until requests:  22%|██▏       | 67/300 [12:15<41:24, 10.66s/it]Running generate_until requests:  23%|██▎       | 68/300 [12:34<51:23, 13.29s/it]Running generate_until requests:  23%|██▎       | 69/300 [12:39<41:44, 10.84s/it]Running generate_until requests:  23%|██▎       | 70/300 [12:59<51:25, 13.41s/it]Running generate_until requests:  24%|██▎       | 71/300 [13:02<39:17, 10.30s/it]Running generate_until requests:  24%|██▍       | 72/300 [13:21<49:28, 13.02s/it]Running generate_until requests:  24%|██▍       | 73/300 [13:31<46:21, 12.25s/it]Running generate_until requests:  25%|██▍       | 74/300 [13:39<41:20, 10.97s/it]Running generate_until requests:  25%|██▌       | 75/300 [13:45<34:44,  9.26s/it]Running generate_until requests:  25%|██▌       | 76/300 [13:51<31:39,  8.48s/it]Running generate_until requests:  26%|██▌       | 77/300 [13:58<29:06,  7.83s/it]Running generate_until requests:  26%|██▌       | 78/300 [14:17<41:26, 11.20s/it]Running generate_until requests:  26%|██▋       | 79/300 [14:25<37:29, 10.18s/it]Running generate_until requests:  27%|██▋       | 80/300 [14:35<37:09, 10.13s/it]Running generate_until requests:  27%|██▋       | 81/300 [14:40<32:06,  8.80s/it]Running generate_until requests:  27%|██▋       | 82/300 [14:46<28:28,  7.84s/it]Running generate_until requests:  28%|██▊       | 83/300 [14:51<25:22,  7.02s/it]Running generate_until requests:  28%|██▊       | 84/300 [14:57<24:08,  6.70s/it]Running generate_until requests:  28%|██▊       | 85/300 [15:05<25:23,  7.09s/it]Running generate_until requests:  29%|██▊       | 86/300 [15:10<23:08,  6.49s/it]Running generate_until requests:  29%|██▉       | 87/300 [15:29<36:21, 10.24s/it]Running generate_until requests:  29%|██▉       | 88/300 [15:37<34:01,  9.63s/it]Running generate_until requests:  30%|██▉       | 89/300 [15:44<30:33,  8.69s/it]Running generate_until requests:  30%|███       | 90/300 [15:51<28:46,  8.22s/it]Running generate_until requests:  30%|███       | 91/300 [15:54<23:27,  6.73s/it]Running generate_until requests:  31%|███       | 92/300 [15:58<19:53,  5.74s/it]Running generate_until requests:  31%|███       | 93/300 [16:09<25:51,  7.49s/it]Running generate_until requests:  31%|███▏      | 94/300 [16:17<26:31,  7.72s/it]Running generate_until requests:  32%|███▏      | 95/300 [16:22<23:12,  6.79s/it]Running generate_until requests:  32%|███▏      | 96/300 [16:25<18:53,  5.56s/it]Running generate_until requests:  32%|███▏      | 97/300 [16:32<20:09,  5.96s/it]Running generate_until requests:  33%|███▎      | 98/300 [16:36<18:51,  5.60s/it]Running generate_until requests:  33%|███▎      | 99/300 [16:41<18:02,  5.39s/it]Running generate_until requests:  33%|███▎      | 100/300 [16:48<19:00,  5.70s/it]Running generate_until requests:  34%|███▎      | 101/300 [16:55<20:36,  6.22s/it]Running generate_until requests:  34%|███▍      | 102/300 [17:01<20:22,  6.18s/it]Running generate_until requests:  34%|███▍      | 103/300 [17:06<19:18,  5.88s/it]Running generate_until requests:  35%|███▍      | 104/300 [17:12<19:08,  5.86s/it]Running generate_until requests:  35%|███▌      | 105/300 [17:14<15:21,  4.73s/it]Running generate_until requests:  35%|███▌      | 106/300 [17:20<16:22,  5.06s/it]Running generate_until requests:  36%|███▌      | 107/300 [17:30<20:52,  6.49s/it]Running generate_until requests:  36%|███▌      | 108/300 [17:35<19:49,  6.20s/it]Running generate_until requests:  36%|███▋      | 109/300 [17:40<18:18,  5.75s/it]Running generate_until requests:  37%|███▋      | 110/300 [17:54<26:06,  8.25s/it]Running generate_until requests:  37%|███▋      | 111/300 [17:59<22:26,  7.12s/it]Running generate_until requests:  37%|███▋      | 112/300 [18:10<26:14,  8.37s/it]Running generate_until requests:  38%|███▊      | 113/300 [18:17<24:38,  7.91s/it]Running generate_until requests:  38%|███▊      | 114/300 [18:20<20:22,  6.57s/it]Running generate_until requests:  38%|███▊      | 115/300 [18:24<17:56,  5.82s/it]Running generate_until requests:  39%|███▊      | 116/300 [18:30<17:21,  5.66s/it]Running generate_until requests:  39%|███▉      | 117/300 [18:35<17:20,  5.69s/it]Running generate_until requests:  39%|███▉      | 118/300 [18:54<29:21,  9.68s/it]Running generate_until requests:  40%|███▉      | 119/300 [19:04<29:33,  9.80s/it]Running generate_until requests:  40%|████      | 120/300 [19:10<25:17,  8.43s/it]Running generate_until requests:  40%|████      | 121/300 [19:12<19:50,  6.65s/it]Running generate_until requests:  41%|████      | 122/300 [19:15<15:53,  5.36s/it]Running generate_until requests:  41%|████      | 123/300 [19:28<22:50,  7.74s/it]Running generate_until requests:  41%|████▏     | 124/300 [19:34<21:04,  7.19s/it]Running generate_until requests:  42%|████▏     | 125/300 [19:39<19:18,  6.62s/it]Running generate_until requests:  42%|████▏     | 126/300 [19:44<17:44,  6.12s/it]Running generate_until requests:  42%|████▏     | 127/300 [19:51<18:00,  6.24s/it]Running generate_until requests:  43%|████▎     | 128/300 [19:54<15:38,  5.46s/it]Running generate_until requests:  43%|████▎     | 129/300 [20:02<17:52,  6.27s/it]Running generate_until requests:  43%|████▎     | 130/300 [20:07<16:50,  5.95s/it]Running generate_until requests:  44%|████▎     | 131/300 [20:10<13:50,  4.91s/it]Running generate_until requests:  44%|████▍     | 132/300 [20:13<12:25,  4.44s/it]Running generate_until requests:  44%|████▍     | 133/300 [20:32<24:34,  8.83s/it]Running generate_until requests:  45%|████▍     | 134/300 [20:39<22:34,  8.16s/it]Running generate_until requests:  45%|████▌     | 135/300 [20:46<21:09,  7.69s/it]Running generate_until requests:  45%|████▌     | 136/300 [20:55<22:29,  8.23s/it]Running generate_until requests:  46%|████▌     | 137/300 [21:03<22:00,  8.10s/it]Running generate_until requests:  46%|████▌     | 138/300 [21:07<19:01,  7.05s/it]Running generate_until requests:  46%|████▋     | 139/300 [21:21<24:30,  9.13s/it]Running generate_until requests:  47%|████▋     | 140/300 [21:31<25:02,  9.39s/it]Running generate_until requests:  47%|████▋     | 141/300 [21:50<32:30, 12.27s/it]Running generate_until requests:  47%|████▋     | 142/300 [21:55<26:19, 10.00s/it]Running generate_until requests:  48%|████▊     | 143/300 [22:06<26:52, 10.27s/it]Running generate_until requests:  48%|████▊     | 144/300 [22:13<24:14,  9.32s/it]Running generate_until requests:  48%|████▊     | 145/300 [22:24<25:23,  9.83s/it]Running generate_until requests:  49%|████▊     | 146/300 [22:29<21:36,  8.42s/it]Running generate_until requests:  49%|████▉     | 147/300 [22:37<20:53,  8.19s/it]Running generate_until requests:  49%|████▉     | 148/300 [22:43<19:27,  7.68s/it]Running generate_until requests:  50%|████▉     | 149/300 [23:02<27:53, 11.08s/it]Running generate_until requests:  50%|█████     | 150/300 [23:10<24:54,  9.96s/it]Running generate_until requests:  50%|█████     | 151/300 [23:16<21:35,  8.70s/it]Running generate_until requests:  51%|█████     | 152/300 [23:20<18:19,  7.43s/it]Running generate_until requests:  51%|█████     | 153/300 [23:39<26:39, 10.88s/it]Running generate_until requests:  51%|█████▏    | 154/300 [23:44<21:56,  9.02s/it]Running generate_until requests:  52%|█████▏    | 155/300 [23:49<19:23,  8.03s/it]Running generate_until requests:  52%|█████▏    | 156/300 [24:02<22:45,  9.49s/it]Running generate_until requests:  52%|█████▏    | 157/300 [24:10<21:35,  9.06s/it]Running generate_until requests:  53%|█████▎    | 158/300 [24:29<28:30, 12.04s/it]Running generate_until requests:  53%|█████▎    | 159/300 [24:33<22:08,  9.42s/it]Running generate_until requests:  53%|█████▎    | 160/300 [24:37<18:13,  7.81s/it]Running generate_until requests:  54%|█████▎    | 161/300 [24:41<15:38,  6.75s/it]Running generate_until requests:  54%|█████▍    | 162/300 [24:47<15:08,  6.58s/it]Running generate_until requests:  54%|█████▍    | 163/300 [24:53<14:30,  6.35s/it]Running generate_until requests:  55%|█████▍    | 164/300 [24:58<13:11,  5.82s/it]Running generate_until requests:  55%|█████▌    | 165/300 [25:06<14:39,  6.51s/it]Running generate_until requests:  55%|█████▌    | 166/300 [25:11<13:59,  6.26s/it]Running generate_until requests:  56%|█████▌    | 167/300 [25:23<17:36,  7.94s/it]Running generate_until requests:  56%|█████▌    | 168/300 [25:30<16:42,  7.59s/it]Running generate_until requests:  56%|█████▋    | 169/300 [25:34<14:15,  6.53s/it]Running generate_until requests:  57%|█████▋    | 170/300 [25:36<10:57,  5.06s/it]Running generate_until requests:  57%|█████▋    | 171/300 [25:48<15:16,  7.10s/it]Running generate_until requests:  57%|█████▋    | 172/300 [25:52<13:35,  6.37s/it]Running generate_until requests:  58%|█████▊    | 173/300 [25:57<12:14,  5.78s/it]Running generate_until requests:  58%|█████▊    | 174/300 [26:01<11:23,  5.42s/it]Running generate_until requests:  58%|█████▊    | 175/300 [26:09<12:46,  6.13s/it]Running generate_until requests:  59%|█████▊    | 176/300 [26:16<13:10,  6.38s/it]Running generate_until requests:  59%|█████▉    | 177/300 [26:19<11:17,  5.51s/it]Running generate_until requests:  59%|█████▉    | 178/300 [26:29<13:38,  6.71s/it]Running generate_until requests:  60%|█████▉    | 179/300 [26:41<16:58,  8.42s/it]Running generate_until requests:  60%|██████    | 180/300 [26:47<15:10,  7.59s/it]Running generate_until requests:  60%|██████    | 181/300 [26:49<11:43,  5.91s/it]Running generate_until requests:  61%|██████    | 182/300 [26:56<12:00,  6.11s/it]Running generate_until requests:  61%|██████    | 183/300 [27:00<11:06,  5.70s/it]Running generate_until requests:  61%|██████▏   | 184/300 [27:10<13:32,  7.01s/it]Running generate_until requests:  62%|██████▏   | 185/300 [27:16<12:48,  6.68s/it]Running generate_until requests:  62%|██████▏   | 186/300 [27:21<11:52,  6.25s/it]Running generate_until requests:  62%|██████▏   | 187/300 [27:32<14:10,  7.53s/it]Running generate_until requests:  63%|██████▎   | 188/300 [27:42<15:12,  8.15s/it]Running generate_until requests:  63%|██████▎   | 189/300 [28:01<21:04, 11.39s/it]Running generate_until requests:  63%|██████▎   | 190/300 [28:05<17:18,  9.44s/it]Running generate_until requests:  64%|██████▎   | 191/300 [28:12<15:41,  8.63s/it]Running generate_until requests:  64%|██████▍   | 192/300 [28:15<12:26,  6.91s/it]Running generate_until requests:  64%|██████▍   | 193/300 [28:21<11:45,  6.59s/it]Running generate_until requests:  65%|██████▍   | 194/300 [28:27<11:12,  6.34s/it]Running generate_until requests:  65%|██████▌   | 195/300 [28:46<17:45, 10.15s/it]Running generate_until requests:  65%|██████▌   | 196/300 [28:53<15:52,  9.16s/it]Running generate_until requests:  66%|██████▌   | 197/300 [29:00<15:00,  8.74s/it]Running generate_until requests:  66%|██████▌   | 198/300 [29:03<11:47,  6.93s/it]Running generate_until requests:  66%|██████▋   | 199/300 [29:10<11:38,  6.92s/it]Running generate_until requests:  67%|██████▋   | 200/300 [29:22<14:16,  8.56s/it]Running generate_until requests:  67%|██████▋   | 201/300 [29:27<12:26,  7.54s/it]Running generate_until requests:  67%|██████▋   | 202/300 [29:31<10:26,  6.39s/it]Running generate_until requests:  68%|██████▊   | 203/300 [29:37<09:56,  6.15s/it]Running generate_until requests:  68%|██████▊   | 204/300 [29:56<15:59, 10.00s/it]Running generate_until requests:  68%|██████▊   | 205/300 [30:02<13:48,  8.72s/it]Running generate_until requests:  69%|██████▊   | 206/300 [30:07<12:12,  7.79s/it]Running generate_until requests:  69%|██████▉   | 207/300 [30:16<12:24,  8.00s/it]Running generate_until requests:  69%|██████▉   | 208/300 [30:23<11:46,  7.68s/it]Running generate_until requests:  70%|██████▉   | 209/300 [30:27<10:07,  6.68s/it]Running generate_until requests:  70%|███████   | 210/300 [30:34<10:22,  6.92s/it]Running generate_until requests:  70%|███████   | 211/300 [30:40<09:49,  6.63s/it]Running generate_until requests:  71%|███████   | 212/300 [30:47<09:44,  6.64s/it]Running generate_until requests:  71%|███████   | 213/300 [30:52<09:02,  6.24s/it]Running generate_until requests:  71%|███████▏  | 214/300 [30:59<09:21,  6.53s/it]Running generate_until requests:  72%|███████▏  | 215/300 [31:06<09:05,  6.42s/it]Running generate_until requests:  72%|███████▏  | 216/300 [31:10<08:00,  5.72s/it]Running generate_until requests:  72%|███████▏  | 217/300 [31:13<06:45,  4.88s/it]Running generate_until requests:  73%|███████▎  | 218/300 [31:19<07:09,  5.24s/it]Running generate_until requests:  73%|███████▎  | 219/300 [31:23<06:35,  4.88s/it]Running generate_until requests:  73%|███████▎  | 220/300 [31:29<07:14,  5.43s/it]Running generate_until requests:  74%|███████▎  | 221/300 [31:34<06:40,  5.07s/it]Running generate_until requests:  74%|███████▍  | 222/300 [31:38<06:21,  4.89s/it]Running generate_until requests:  74%|███████▍  | 223/300 [31:44<06:42,  5.23s/it]Running generate_until requests:  75%|███████▍  | 224/300 [31:55<08:40,  6.85s/it]Running generate_until requests:  75%|███████▌  | 225/300 [31:59<07:21,  5.89s/it]Running generate_until requests:  75%|███████▌  | 226/300 [32:02<06:30,  5.27s/it]Running generate_until requests:  76%|███████▌  | 227/300 [32:09<06:54,  5.68s/it]Running generate_until requests:  76%|███████▌  | 228/300 [32:14<06:39,  5.55s/it]Running generate_until requests:  76%|███████▋  | 229/300 [32:33<11:19,  9.57s/it]Running generate_until requests:  77%|███████▋  | 230/300 [32:38<09:33,  8.20s/it]Running generate_until requests:  77%|███████▋  | 231/300 [32:56<12:48, 11.14s/it]Running generate_until requests:  77%|███████▋  | 232/300 [33:06<12:17, 10.84s/it]Running generate_until requests:  78%|███████▊  | 233/300 [33:10<09:48,  8.79s/it]Running generate_until requests:  78%|███████▊  | 234/300 [33:15<08:12,  7.46s/it]Running generate_until requests:  78%|███████▊  | 235/300 [33:17<06:22,  5.88s/it]Running generate_until requests:  79%|███████▊  | 236/300 [33:22<06:05,  5.72s/it]Running generate_until requests:  79%|███████▉  | 237/300 [33:26<05:26,  5.18s/it]Running generate_until requests:  79%|███████▉  | 238/300 [33:31<05:12,  5.04s/it]Running generate_until requests:  80%|███████▉  | 239/300 [33:35<04:48,  4.72s/it]Running generate_until requests:  80%|████████  | 240/300 [33:41<05:12,  5.22s/it]Running generate_until requests:  80%|████████  | 241/300 [33:46<04:57,  5.04s/it]Running generate_until requests:  81%|████████  | 242/300 [33:51<04:52,  5.04s/it]Running generate_until requests:  81%|████████  | 243/300 [33:55<04:26,  4.68s/it]Running generate_until requests:  81%|████████▏ | 244/300 [33:57<03:40,  3.94s/it]Running generate_until requests:  82%|████████▏ | 245/300 [34:02<03:56,  4.29s/it]Running generate_until requests:  82%|████████▏ | 246/300 [34:09<04:38,  5.16s/it]Running generate_until requests:  82%|████████▏ | 247/300 [34:14<04:27,  5.05s/it]Running generate_until requests:  83%|████████▎ | 248/300 [34:16<03:32,  4.08s/it]Running generate_until requests:  83%|████████▎ | 249/300 [34:23<04:17,  5.06s/it]Running generate_until requests:  83%|████████▎ | 250/300 [34:30<04:41,  5.63s/it]Running generate_until requests:  84%|████████▎ | 251/300 [34:34<04:07,  5.04s/it]Running generate_until requests:  84%|████████▍ | 252/300 [34:41<04:26,  5.54s/it]Running generate_until requests:  84%|████████▍ | 253/300 [34:45<04:00,  5.12s/it]Running generate_until requests:  85%|████████▍ | 254/300 [34:47<03:11,  4.17s/it]Running generate_until requests:  85%|████████▌ | 255/300 [35:06<06:27,  8.62s/it]Running generate_until requests:  85%|████████▌ | 256/300 [35:16<06:42,  9.14s/it]Running generate_until requests:  86%|████████▌ | 257/300 [35:19<05:15,  7.34s/it]Running generate_until requests:  86%|████████▌ | 258/300 [35:23<04:30,  6.43s/it]Running generate_until requests:  86%|████████▋ | 259/300 [35:37<05:46,  8.46s/it]Running generate_until requests:  87%|████████▋ | 260/300 [35:44<05:20,  8.00s/it]Running generate_until requests:  87%|████████▋ | 261/300 [35:52<05:17,  8.15s/it]Running generate_until requests:  87%|████████▋ | 262/300 [35:57<04:32,  7.18s/it]Running generate_until requests:  88%|████████▊ | 263/300 [36:04<04:20,  7.04s/it]Running generate_until requests:  88%|████████▊ | 264/300 [36:07<03:30,  5.83s/it]Running generate_until requests:  88%|████████▊ | 265/300 [36:13<03:34,  6.12s/it]Running generate_until requests:  89%|████████▊ | 266/300 [36:18<03:16,  5.77s/it]Running generate_until requests:  89%|████████▉ | 267/300 [36:24<03:09,  5.73s/it]Running generate_until requests:  89%|████████▉ | 268/300 [36:26<02:26,  4.57s/it]Running generate_until requests:  90%|████████▉ | 269/300 [36:36<03:13,  6.25s/it]Running generate_until requests:  90%|█████████ | 270/300 [36:41<02:58,  5.96s/it]Running generate_until requests:  90%|█████████ | 271/300 [36:51<03:22,  6.97s/it]Running generate_until requests:  91%|█████████ | 272/300 [36:56<03:02,  6.52s/it]Running generate_until requests:  91%|█████████ | 273/300 [37:07<03:28,  7.72s/it]Running generate_until requests:  91%|█████████▏| 274/300 [37:26<04:48, 11.11s/it]Running generate_until requests:  92%|█████████▏| 275/300 [37:29<03:41,  8.85s/it]Running generate_until requests:  92%|█████████▏| 276/300 [37:31<02:44,  6.85s/it]Running generate_until requests:  92%|█████████▏| 277/300 [37:36<02:23,  6.25s/it]Running generate_until requests:  93%|█████████▎| 278/300 [37:46<02:40,  7.29s/it]Running generate_until requests:  93%|█████████▎| 279/300 [37:59<03:07,  8.91s/it]Running generate_until requests:  93%|█████████▎| 280/300 [38:02<02:26,  7.34s/it]Running generate_until requests:  94%|█████████▎| 281/300 [38:07<02:05,  6.62s/it]Running generate_until requests:  94%|█████████▍| 282/300 [38:13<01:52,  6.27s/it]Running generate_until requests:  94%|█████████▍| 283/300 [38:21<01:55,  6.81s/it]Running generate_until requests:  95%|█████████▍| 284/300 [38:29<01:54,  7.14s/it]Running generate_until requests:  95%|█████████▌| 285/300 [38:36<01:48,  7.26s/it]Running generate_until requests:  95%|█████████▌| 286/300 [38:45<01:46,  7.63s/it]Running generate_until requests:  96%|█████████▌| 287/300 [38:49<01:25,  6.55s/it]Running generate_until requests:  96%|█████████▌| 288/300 [38:54<01:13,  6.10s/it]Running generate_until requests:  96%|█████████▋| 289/300 [39:07<01:30,  8.20s/it]Running generate_until requests:  97%|█████████▋| 290/300 [39:10<01:05,  6.56s/it]Running generate_until requests:  97%|█████████▋| 291/300 [39:17<01:01,  6.88s/it]Running generate_until requests:  97%|█████████▋| 292/300 [39:28<01:03,  7.99s/it]Running generate_until requests:  98%|█████████▊| 293/300 [39:30<00:43,  6.18s/it]Running generate_until requests:  98%|█████████▊| 294/300 [39:35<00:35,  5.92s/it]Running generate_until requests:  98%|█████████▊| 295/300 [39:38<00:24,  4.87s/it]Running generate_until requests:  99%|█████████▊| 296/300 [39:46<00:23,  5.79s/it]Running generate_until requests:  99%|█████████▉| 297/300 [39:48<00:14,  4.91s/it]Running generate_until requests:  99%|█████████▉| 298/300 [39:50<00:08,  4.05s/it]Running generate_until requests: 100%|█████████▉| 299/300 [39:57<00:04,  4.67s/it]Running generate_until requests: 100%|██████████| 300/300 [39:59<00:00,  4.08s/it]Running generate_until requests: 100%|██████████| 300/300 [39:59<00:00,  8.00s/it]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2025-03-31:18:07:48,597 WARNING  [huggingface.py:122] `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
2025-03-31:18:07:49,317 WARNING  [huggingface.py:329] Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
2025-03-31:18:07:49,318 INFO     [evaluator.py:152] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2025-03-31:18:07:49,318 INFO     [evaluator.py:203] Using pre-initialized model
2025-03-31:18:08:01,935 WARNING  [evaluator.py:251] Overwriting default num_fewshot of gsm8k from 5 to 5
2025-03-31:18:08:01,935 INFO     [evaluator.py:261] Setting fewshot random generator seed to 1234
2025-03-31:18:08:01,937 INFO     [task.py:411] Building contexts for gsm8k on rank 0...
finish_task gsm8k
|Tasks|Version|     Filter     |n-shot|  Metric   |   |Value|   |Stderr|
|-----|------:|----------------|-----:|-----------|---|----:|---|-----:|
|gsm8k|      3|flexible-extract|     3|exact_match|↑  | 0.34|±  |0.0274|
|     |       |strict-match    |     3|exact_match|↑  | 0.34|±  |0.0274|

========================================
end : sp_config:  (0.5, 0.5, 0.0, 0) num_shot:  3
results
|Tasks|Version|     Filter     |n-shot|  Metric   |   |Value|   |Stderr|
|-----|------:|----------------|-----:|-----------|---|----:|---|-----:|
|gsm8k|      3|flexible-extract|     3|exact_match|↑  | 0.34|±  |0.0274|
|     |       |strict-match    |     3|exact_match|↑  | 0.34|±  |0.0274|

========================================
begin : sp_config:  (0.5, 0.5, 0.0, 0) num_shot:  5
Init Reset
Set sparsity: attn 0.5, mlp 0.5, w 0.0
Set pre-prediction: 0
set_sparsity_threshold
threshold_path /data/wzw/wzw/BitDistiller-Q4_0/data/threshold/Meta-Llama-3-8B/sparse-0.5.json
sparsity_strategy :  Static
sparsity_strategy:  Static
  0%|          | 0/300 [00:00<?, ?it/s]  7%|▋         | 21/300 [00:00<00:01, 206.63it/s] 14%|█▍        | 43/300 [00:00<00:01, 210.30it/s] 22%|██▏       | 65/300 [00:00<00:01, 211.93it/s] 29%|██▉       | 87/300 [00:00<00:01, 210.93it/s] 36%|███▋      | 109/300 [00:00<00:00, 210.87it/s] 44%|████▎     | 131/300 [00:00<00:00, 211.04it/s] 51%|█████     | 153/300 [00:00<00:00, 210.95it/s] 58%|█████▊    | 175/300 [00:00<00:00, 210.78it/s] 66%|██████▌   | 197/300 [00:00<00:00, 211.50it/s] 73%|███████▎  | 219/300 [00:01<00:00, 208.62it/s] 80%|████████  | 240/300 [00:01<00:00, 208.15it/s] 87%|████████▋ | 261/300 [00:01<00:00, 208.27it/s] 94%|█████████▍| 282/300 [00:01<00:00, 208.54it/s]100%|██████████| 300/300 [00:01<00:00, 209.75it/s]
2025-03-31:18:08:03,376 INFO     [evaluator.py:438] Running generate_until requests
Running generate_until requests:   0%|          | 0/300 [00:00<?, ?it/s]/home/donglinbai/miniconda3/envs/sparse/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/donglinbai/miniconda3/envs/sparse/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Running generate_until requests:   0%|          | 1/300 [00:08<42:16,  8.48s/it]Running generate_until requests:   1%|          | 2/300 [00:11<27:25,  5.52s/it]Running generate_until requests:   1%|          | 3/300 [00:18<29:21,  5.93s/it]Running generate_until requests:   1%|▏         | 4/300 [00:24<29:59,  6.08s/it]Running generate_until requests:   2%|▏         | 5/300 [00:37<41:40,  8.48s/it]Running generate_until requests:   2%|▏         | 6/300 [00:45<41:13,  8.41s/it]Running generate_until requests:   2%|▏         | 7/300 [01:05<58:54, 12.06s/it]Running generate_until requests:   3%|▎         | 8/300 [01:12<50:50, 10.45s/it]Running generate_until requests:   3%|▎         | 9/300 [01:19<46:04,  9.50s/it]Running generate_until requests:   3%|▎         | 10/300 [01:26<41:20,  8.55s/it]Running generate_until requests:   4%|▎         | 11/300 [01:35<42:08,  8.75s/it]Running generate_until requests:   4%|▍         | 12/300 [01:41<39:00,  8.13s/it]Running generate_until requests:   4%|▍         | 13/300 [01:45<32:33,  6.81s/it]Running generate_until requests:   5%|▍         | 14/300 [01:48<27:04,  5.68s/it]Running generate_until requests:   5%|▌         | 15/300 [01:56<30:15,  6.37s/it]Running generate_until requests:   5%|▌         | 16/300 [02:07<36:01,  7.61s/it]Running generate_until requests:   6%|▌         | 17/300 [02:12<32:47,  6.95s/it]Running generate_until requests:   6%|▌         | 18/300 [02:19<32:01,  6.81s/it]Running generate_until requests:   6%|▋         | 19/300 [02:30<37:56,  8.10s/it]Running generate_until requests:   7%|▋         | 20/300 [02:45<47:58, 10.28s/it]Running generate_until requests:   7%|▋         | 21/300 [03:05<1:00:44, 13.06s/it]Running generate_until requests:   7%|▋         | 22/300 [03:17<59:18, 12.80s/it]  Running generate_until requests:   8%|▊         | 23/300 [03:26<54:12, 11.74s/it]Running generate_until requests:   8%|▊         | 24/300 [03:30<42:49,  9.31s/it]Running generate_until requests:   8%|▊         | 25/300 [03:36<38:11,  8.33s/it]Running generate_until requests:   9%|▊         | 26/300 [03:47<41:58,  9.19s/it]Running generate_until requests:   9%|▉         | 27/300 [03:52<36:13,  7.96s/it]Running generate_until requests:   9%|▉         | 28/300 [03:55<28:44,  6.34s/it]Running generate_until requests:  10%|▉         | 29/300 [04:03<31:49,  7.05s/it]Running generate_until requests:  10%|█         | 30/300 [04:13<35:01,  7.78s/it]Running generate_until requests:  10%|█         | 31/300 [04:21<35:45,  7.98s/it]Running generate_until requests:  11%|█         | 32/300 [04:26<30:47,  6.89s/it]Running generate_until requests:  11%|█         | 33/300 [04:37<35:59,  8.09s/it]Running generate_until requests:  11%|█▏        | 34/300 [04:43<33:39,  7.59s/it]Running generate_until requests:  12%|█▏        | 35/300 [04:47<29:12,  6.61s/it]Running generate_until requests:  12%|█▏        | 36/300 [04:56<31:29,  7.16s/it]Running generate_until requests:  12%|█▏        | 37/300 [05:02<30:46,  7.02s/it]Running generate_until requests:  13%|█▎        | 38/300 [05:22<46:55, 10.75s/it]Running generate_until requests:  13%|█▎        | 39/300 [05:25<36:09,  8.31s/it]Running generate_until requests:  13%|█▎        | 40/300 [05:44<50:25, 11.64s/it]Running generate_until requests:  14%|█▎        | 41/300 [05:47<38:46,  8.98s/it]Running generate_until requests:  14%|█▍        | 42/300 [05:53<35:29,  8.25s/it]Running generate_until requests:  14%|█▍        | 43/300 [06:06<41:17,  9.64s/it]Running generate_until requests:  15%|█▍        | 44/300 [06:19<44:49, 10.51s/it]Running generate_until requests:  15%|█▌        | 45/300 [06:38<55:56, 13.16s/it]Running generate_until requests:  15%|█▌        | 46/300 [06:43<45:32, 10.76s/it]Running generate_until requests:  16%|█▌        | 47/300 [06:49<38:51,  9.22s/it]Running generate_until requests:  16%|█▌        | 48/300 [06:53<32:29,  7.74s/it]Running generate_until requests:  16%|█▋        | 49/300 [07:02<33:35,  8.03s/it]Running generate_until requests:  17%|█▋        | 50/300 [07:09<32:00,  7.68s/it]Running generate_until requests:  17%|█▋        | 51/300 [07:14<28:38,  6.90s/it]Running generate_until requests:  17%|█▋        | 52/300 [07:17<24:07,  5.84s/it]Running generate_until requests:  18%|█▊        | 53/300 [07:23<23:45,  5.77s/it]Running generate_until requests:  18%|█▊        | 54/300 [07:41<39:18,  9.59s/it]Running generate_until requests:  18%|█▊        | 55/300 [07:47<34:47,  8.52s/it]Running generate_until requests:  19%|█▊        | 56/300 [08:03<43:02, 10.58s/it]Running generate_until requests:  19%|█▉        | 57/300 [08:13<42:32, 10.50s/it]Running generate_until requests:  19%|█▉        | 58/300 [08:22<40:47, 10.11s/it]Running generate_until requests:  20%|█▉        | 59/300 [08:31<39:27,  9.83s/it]Running generate_until requests:  20%|██        | 60/300 [08:40<37:55,  9.48s/it]Running generate_until requests:  20%|██        | 61/300 [08:51<39:36,  9.95s/it]Running generate_until requests:  21%|██        | 62/300 [09:04<42:40, 10.76s/it]Running generate_until requests:  21%|██        | 63/300 [09:11<38:46,  9.82s/it]Running generate_until requests:  21%|██▏       | 64/300 [09:24<42:31, 10.81s/it]Running generate_until requests:  22%|██▏       | 65/300 [09:28<33:46,  8.62s/it]Running generate_until requests:  22%|██▏       | 66/300 [09:34<30:57,  7.94s/it]Running generate_until requests:  22%|██▏       | 67/300 [09:38<25:55,  6.68s/it]Running generate_until requests:  23%|██▎       | 68/300 [09:43<24:18,  6.29s/it]Running generate_until requests:  23%|██▎       | 69/300 [09:55<30:02,  7.80s/it]Running generate_until requests:  23%|██▎       | 70/300 [10:06<34:01,  8.88s/it]Running generate_until requests:  24%|██▎       | 71/300 [10:12<30:35,  8.01s/it]Running generate_until requests:  24%|██▍       | 72/300 [10:32<43:29, 11.44s/it]Running generate_until requests:  24%|██▍       | 73/300 [10:51<52:12, 13.80s/it]Running generate_until requests:  25%|██▍       | 74/300 [11:01<47:29, 12.61s/it]Running generate_until requests:  25%|██▌       | 75/300 [11:09<42:02, 11.21s/it]Running generate_until requests:  25%|██▌       | 76/300 [11:19<40:56, 10.97s/it]Running generate_until requests:  26%|██▌       | 77/300 [11:38<50:10, 13.50s/it]Running generate_until requests:  26%|██▌       | 78/300 [11:45<41:51, 11.31s/it]Running generate_until requests:  26%|██▋       | 79/300 [11:54<39:02, 10.60s/it]Running generate_until requests:  27%|██▋       | 80/300 [12:00<34:21,  9.37s/it]Running generate_until requests:  27%|██▋       | 81/300 [12:07<31:55,  8.75s/it]Running generate_until requests:  27%|██▋       | 82/300 [12:13<27:48,  7.66s/it]Running generate_until requests:  28%|██▊       | 83/300 [12:16<23:11,  6.41s/it]Running generate_until requests:  28%|██▊       | 84/300 [12:27<27:36,  7.67s/it]Running generate_until requests:  28%|██▊       | 85/300 [12:34<26:39,  7.44s/it]Running generate_until requests:  29%|██▊       | 86/300 [12:40<25:50,  7.24s/it]Running generate_until requests:  29%|██▉       | 87/300 [12:55<34:00,  9.58s/it]Running generate_until requests:  29%|██▉       | 88/300 [13:07<36:01, 10.19s/it]Running generate_until requests:  30%|██▉       | 89/300 [13:13<30:59,  8.81s/it]Running generate_until requests:  30%|███       | 90/300 [13:17<26:35,  7.60s/it]Running generate_until requests:  30%|███       | 91/300 [13:25<26:55,  7.73s/it]Running generate_until requests:  31%|███       | 92/300 [13:27<20:58,  6.05s/it]Running generate_until requests:  31%|███       | 93/300 [13:32<19:40,  5.70s/it]Running generate_until requests:  31%|███▏      | 94/300 [13:37<18:46,  5.47s/it]Running generate_until requests:  32%|███▏      | 95/300 [13:51<27:31,  8.05s/it]Running generate_until requests:  32%|███▏      | 96/300 [13:55<22:41,  6.67s/it]Running generate_until requests:  32%|███▏      | 97/300 [13:57<17:55,  5.30s/it]Running generate_until requests:  33%|███▎      | 98/300 [14:02<17:25,  5.18s/it]Running generate_until requests:  33%|███▎      | 99/300 [14:08<18:18,  5.47s/it]Running generate_until requests:  33%|███▎      | 100/300 [14:27<32:03,  9.62s/it]Running generate_until requests:  34%|███▎      | 101/300 [14:40<34:32, 10.41s/it]Running generate_until requests:  34%|███▍      | 102/300 [14:46<30:04,  9.11s/it]Running generate_until requests:  34%|███▍      | 103/300 [14:51<25:48,  7.86s/it]Running generate_until requests:  35%|███▍      | 104/300 [15:00<26:49,  8.21s/it]Running generate_until requests:  35%|███▌      | 105/300 [15:02<20:42,  6.37s/it]Running generate_until requests:  35%|███▌      | 106/300 [15:21<33:06, 10.24s/it]Running generate_until requests:  36%|███▌      | 107/300 [15:26<27:57,  8.69s/it]Running generate_until requests:  36%|███▌      | 108/300 [15:29<21:58,  6.87s/it]Running generate_until requests:  36%|███▋      | 109/300 [15:35<21:33,  6.77s/it]Running generate_until requests:  37%|███▋      | 110/300 [15:39<18:50,  5.95s/it]Running generate_until requests:  37%|███▋      | 111/300 [15:45<19:02,  6.04s/it]Running generate_until requests:  37%|███▋      | 112/300 [15:53<20:27,  6.53s/it]Running generate_until requests:  38%|███▊      | 113/300 [16:01<21:25,  6.88s/it]Running generate_until requests:  38%|███▊      | 114/300 [16:05<19:09,  6.18s/it]Running generate_until requests:  38%|███▊      | 115/300 [16:09<16:17,  5.28s/it]Running generate_until requests:  39%|███▊      | 116/300 [16:14<16:33,  5.40s/it]Running generate_until requests:  39%|███▉      | 117/300 [16:22<18:50,  6.18s/it]Running generate_until requests:  39%|███▉      | 118/300 [16:27<17:03,  5.62s/it]Running generate_until requests:  40%|███▉      | 119/300 [16:35<19:13,  6.37s/it]Running generate_until requests:  40%|████      | 120/300 [16:39<17:20,  5.78s/it]Running generate_until requests:  40%|████      | 121/300 [16:48<20:25,  6.85s/it]Running generate_until requests:  41%|████      | 122/300 [16:51<16:27,  5.55s/it]Running generate_until requests:  41%|████      | 123/300 [17:04<22:40,  7.69s/it]Running generate_until requests:  41%|████▏     | 124/300 [17:09<20:11,  6.89s/it]Running generate_until requests:  42%|████▏     | 125/300 [17:12<17:09,  5.88s/it]Running generate_until requests:  42%|████▏     | 126/300 [17:16<14:59,  5.17s/it]Running generate_until requests:  42%|████▏     | 127/300 [17:35<27:12,  9.44s/it]Running generate_until requests:  43%|████▎     | 128/300 [17:42<24:46,  8.64s/it]Running generate_until requests:  43%|████▎     | 129/300 [17:52<25:30,  8.95s/it]Running generate_until requests:  43%|████▎     | 130/300 [17:59<23:58,  8.46s/it]Running generate_until requests:  44%|████▎     | 131/300 [18:01<18:41,  6.64s/it]Running generate_until requests:  44%|████▍     | 132/300 [18:03<14:45,  5.27s/it]Running generate_until requests:  44%|████▍     | 133/300 [18:13<18:12,  6.54s/it]Running generate_until requests:  45%|████▍     | 134/300 [18:15<14:46,  5.34s/it]Running generate_until requests:  45%|████▌     | 135/300 [18:24<17:09,  6.24s/it]Running generate_until requests:  45%|████▌     | 136/300 [18:28<15:34,  5.70s/it]Running generate_until requests:  46%|████▌     | 137/300 [18:41<21:04,  7.76s/it]Running generate_until requests:  46%|████▌     | 138/300 [18:51<22:53,  8.48s/it]Running generate_until requests:  46%|████▋     | 139/300 [18:56<20:23,  7.60s/it]Running generate_until requests:  47%|████▋     | 140/300 [19:03<19:48,  7.43s/it]Running generate_until requests:  47%|████▋     | 141/300 [19:07<16:46,  6.33s/it]Running generate_until requests:  47%|████▋     | 142/300 [19:15<17:40,  6.71s/it]Running generate_until requests:  48%|████▊     | 143/300 [19:22<17:58,  6.87s/it]Running generate_until requests:  48%|████▊     | 144/300 [19:27<16:11,  6.23s/it]Running generate_until requests:  48%|████▊     | 145/300 [19:37<19:04,  7.38s/it]Running generate_until requests:  49%|████▊     | 146/300 [19:43<17:38,  6.87s/it]Running generate_until requests:  49%|████▉     | 147/300 [19:49<16:52,  6.62s/it]Running generate_until requests:  49%|████▉     | 148/300 [19:57<18:25,  7.28s/it]Running generate_until requests:  50%|████▉     | 149/300 [20:07<20:26,  8.12s/it]Running generate_until requests:  50%|█████     | 150/300 [20:12<17:24,  6.96s/it]Running generate_until requests:  50%|█████     | 151/300 [20:18<17:00,  6.85s/it]Running generate_until requests:  51%|█████     | 152/300 [20:22<14:55,  6.05s/it]Running generate_until requests:  51%|█████     | 153/300 [20:27<13:43,  5.60s/it]Running generate_until requests:  51%|█████▏    | 154/300 [20:32<13:31,  5.56s/it]Running generate_until requests:  52%|█████▏    | 155/300 [20:40<14:45,  6.11s/it]Running generate_until requests:  52%|█████▏    | 156/300 [20:50<17:31,  7.30s/it]Running generate_until requests:  52%|█████▏    | 157/300 [20:59<18:56,  7.95s/it]Running generate_until requests:  53%|█████▎    | 158/300 [21:04<16:25,  6.94s/it]Running generate_until requests:  53%|█████▎    | 159/300 [21:23<25:02, 10.66s/it]Running generate_until requests:  53%|█████▎    | 160/300 [21:33<23:52, 10.23s/it]Running generate_until requests:  54%|█████▎    | 161/300 [21:52<30:09, 13.02s/it]Running generate_until requests:  54%|█████▍    | 162/300 [22:00<26:29, 11.52s/it]Running generate_until requests:  54%|█████▍    | 163/300 [22:08<23:35, 10.33s/it]Running generate_until requests:  55%|█████▍    | 164/300 [22:15<21:37,  9.54s/it]Running generate_until requests:  55%|█████▌    | 165/300 [22:24<21:02,  9.35s/it]Running generate_until requests:  55%|█████▌    | 166/300 [22:29<18:04,  8.10s/it]Running generate_until requests:  56%|█████▌    | 167/300 [22:34<15:38,  7.06s/it]Running generate_until requests:  56%|█████▌    | 168/300 [22:43<16:50,  7.65s/it]Running generate_until requests:  56%|█████▋    | 169/300 [22:49<15:35,  7.14s/it]Running generate_until requests:  57%|█████▋    | 170/300 [22:52<12:33,  5.80s/it]Running generate_until requests:  57%|█████▋    | 171/300 [23:00<14:04,  6.55s/it]Running generate_until requests:  57%|█████▋    | 172/300 [23:06<13:32,  6.35s/it]Running generate_until requests:  58%|█████▊    | 173/300 [23:14<14:40,  6.94s/it]Running generate_until requests:  58%|█████▊    | 174/300 [23:20<14:07,  6.72s/it]Running generate_until requests:  58%|█████▊    | 175/300 [23:30<16:00,  7.68s/it]Running generate_until requests:  59%|█████▊    | 176/300 [23:50<23:06, 11.18s/it]Running generate_until requests:  59%|█████▉    | 177/300 [23:55<19:12,  9.37s/it]Running generate_until requests:  59%|█████▉    | 178/300 [24:01<16:53,  8.31s/it]Running generate_until requests:  60%|█████▉    | 179/300 [24:03<13:16,  6.59s/it]Running generate_until requests:  60%|██████    | 180/300 [24:11<13:39,  6.83s/it]Running generate_until requests:  60%|██████    | 181/300 [24:30<21:01, 10.60s/it]Running generate_until requests:  61%|██████    | 182/300 [24:38<19:26,  9.89s/it]Running generate_until requests:  61%|██████    | 183/300 [24:42<15:56,  8.17s/it]Running generate_until requests:  61%|██████▏   | 184/300 [24:52<16:35,  8.58s/it]Running generate_until requests:  62%|██████▏   | 185/300 [25:03<17:59,  9.39s/it]Running generate_until requests:  62%|██████▏   | 186/300 [25:14<18:24,  9.69s/it]Running generate_until requests:  62%|██████▏   | 187/300 [25:17<14:37,  7.77s/it]Running generate_until requests:  63%|██████▎   | 188/300 [25:23<13:25,  7.19s/it]Running generate_until requests:  63%|██████▎   | 189/300 [25:29<12:47,  6.92s/it]Running generate_until requests:  63%|██████▎   | 190/300 [25:32<10:45,  5.87s/it]Running generate_until requests:  64%|██████▎   | 191/300 [25:41<12:04,  6.65s/it]Running generate_until requests:  64%|██████▍   | 192/300 [25:49<12:43,  7.07s/it]Running generate_until requests:  64%|██████▍   | 193/300 [25:59<14:22,  8.06s/it]Running generate_until requests:  65%|██████▍   | 194/300 [26:04<12:37,  7.15s/it]Running generate_until requests:  65%|██████▌   | 195/300 [26:18<15:58,  9.13s/it]Running generate_until requests:  65%|██████▌   | 196/300 [26:27<15:34,  8.99s/it]Running generate_until requests:  66%|██████▌   | 197/300 [26:29<12:05,  7.04s/it]Running generate_until requests:  66%|██████▌   | 198/300 [26:32<09:58,  5.86s/it]Running generate_until requests:  66%|██████▋   | 199/300 [26:39<10:09,  6.03s/it]Running generate_until requests:  67%|██████▋   | 200/300 [26:45<09:54,  5.95s/it]Running generate_until requests:  67%|██████▋   | 201/300 [27:04<16:28,  9.98s/it]Running generate_until requests:  67%|██████▋   | 202/300 [27:11<14:53,  9.12s/it]Running generate_until requests:  68%|██████▊   | 203/300 [27:16<12:37,  7.81s/it]Running generate_until requests:  68%|██████▊   | 204/300 [27:19<10:25,  6.51s/it]Running generate_until requests:  68%|██████▊   | 205/300 [27:31<12:54,  8.15s/it]Running generate_until requests:  69%|██████▊   | 206/300 [27:38<12:08,  7.75s/it]Running generate_until requests:  69%|██████▉   | 207/300 [27:43<10:35,  6.83s/it]Running generate_until requests:  69%|██████▉   | 208/300 [27:54<12:25,  8.10s/it]Running generate_until requests:  70%|██████▉   | 209/300 [28:00<11:22,  7.50s/it]Running generate_until requests:  70%|███████   | 210/300 [28:09<11:59,  8.00s/it]Running generate_until requests:  70%|███████   | 211/300 [28:13<10:05,  6.81s/it]Running generate_until requests:  71%|███████   | 212/300 [28:19<09:26,  6.44s/it]Running generate_until requests:  71%|███████   | 213/300 [28:24<08:55,  6.16s/it]Running generate_until requests:  71%|███████▏  | 214/300 [28:31<08:56,  6.24s/it]Running generate_until requests:  72%|███████▏  | 215/300 [28:36<08:28,  5.98s/it]Running generate_until requests:  72%|███████▏  | 216/300 [28:39<07:12,  5.15s/it]Running generate_until requests:  72%|███████▏  | 217/300 [28:47<08:11,  5.92s/it]Running generate_until requests:  73%|███████▎  | 218/300 [28:53<08:10,  5.98s/it]Running generate_until requests:  73%|███████▎  | 219/300 [28:56<06:38,  4.92s/it]Running generate_until requests:  73%|███████▎  | 220/300 [28:59<05:56,  4.45s/it]Running generate_until requests:  74%|███████▎  | 221/300 [29:02<05:26,  4.14s/it]Running generate_until requests:  74%|███████▍  | 222/300 [29:06<05:21,  4.12s/it]Running generate_until requests:  74%|███████▍  | 223/300 [29:12<06:02,  4.71s/it]Running generate_until requests:  75%|███████▍  | 224/300 [29:22<07:53,  6.23s/it]Running generate_until requests:  75%|███████▌  | 225/300 [29:25<06:33,  5.25s/it]Running generate_until requests:  75%|███████▌  | 226/300 [29:45<11:41,  9.49s/it]Running generate_until requests:  76%|███████▌  | 227/300 [29:48<09:30,  7.82s/it]Running generate_until requests:  76%|███████▌  | 228/300 [29:53<08:13,  6.86s/it]Running generate_until requests:  76%|███████▋  | 229/300 [29:58<07:22,  6.24s/it]Running generate_until requests:  77%|███████▋  | 230/300 [30:06<07:57,  6.82s/it]Running generate_until requests:  77%|███████▋  | 231/300 [30:11<07:21,  6.40s/it]Running generate_until requests:  77%|███████▋  | 232/300 [30:18<07:22,  6.51s/it]Running generate_until requests:  78%|███████▊  | 233/300 [30:24<07:07,  6.38s/it]Running generate_until requests:  78%|███████▊  | 234/300 [30:32<07:33,  6.87s/it]Running generate_until requests:  78%|███████▊  | 235/300 [30:37<06:41,  6.18s/it]Running generate_until requests:  79%|███████▊  | 236/300 [30:44<06:48,  6.38s/it]Running generate_until requests:  79%|███████▉  | 237/300 [30:53<07:35,  7.22s/it]Running generate_until requests:  79%|███████▉  | 238/300 [31:00<07:24,  7.17s/it]Running generate_until requests:  80%|███████▉  | 239/300 [31:05<06:33,  6.45s/it]Running generate_until requests:  80%|████████  | 240/300 [31:12<06:34,  6.57s/it]Running generate_until requests:  80%|████████  | 241/300 [31:15<05:37,  5.72s/it]Running generate_until requests:  81%|████████  | 242/300 [31:20<05:16,  5.45s/it]Running generate_until requests:  81%|████████  | 243/300 [31:36<08:03,  8.49s/it]Running generate_until requests:  81%|████████▏ | 244/300 [31:39<06:23,  6.85s/it]Running generate_until requests:  82%|████████▏ | 245/300 [31:58<09:41, 10.58s/it]Running generate_until requests:  82%|████████▏ | 246/300 [32:00<07:16,  8.09s/it]Running generate_until requests:  82%|████████▏ | 247/300 [32:06<06:37,  7.50s/it]Running generate_until requests:  83%|████████▎ | 248/300 [32:09<05:17,  6.11s/it]Running generate_until requests:  83%|████████▎ | 249/300 [32:24<07:26,  8.76s/it]Running generate_until requests:  83%|████████▎ | 250/300 [32:32<07:03,  8.47s/it]Running generate_until requests:  84%|████████▎ | 251/300 [32:34<05:25,  6.65s/it]Running generate_until requests:  84%|████████▍ | 252/300 [32:42<05:34,  6.96s/it]Running generate_until requests:  84%|████████▍ | 253/300 [32:49<05:21,  6.85s/it]Running generate_until requests:  85%|████████▍ | 254/300 [32:51<04:18,  5.61s/it]Running generate_until requests:  85%|████████▌ | 255/300 [32:54<03:25,  4.57s/it]Running generate_until requests:  85%|████████▌ | 256/300 [33:03<04:30,  6.16s/it]Running generate_until requests:  86%|████████▌ | 257/300 [33:08<03:58,  5.54s/it]Running generate_until requests:  86%|████████▌ | 258/300 [33:12<03:39,  5.22s/it]Running generate_until requests:  86%|████████▋ | 259/300 [33:20<04:11,  6.12s/it]Running generate_until requests:  87%|████████▋ | 260/300 [33:27<04:17,  6.44s/it]Running generate_until requests:  87%|████████▋ | 261/300 [33:33<04:03,  6.24s/it]Running generate_until requests:  87%|████████▋ | 262/300 [33:36<03:13,  5.09s/it]Running generate_until requests:  88%|████████▊ | 263/300 [33:40<03:03,  4.95s/it]Running generate_until requests:  88%|████████▊ | 264/300 [33:45<02:53,  4.82s/it]Running generate_until requests:  88%|████████▊ | 265/300 [33:49<02:39,  4.57s/it]Running generate_until requests:  89%|████████▊ | 266/300 [33:54<02:44,  4.83s/it]Running generate_until requests:  89%|████████▉ | 267/300 [34:03<03:17,  5.98s/it]Running generate_until requests:  89%|████████▉ | 268/300 [34:06<02:40,  5.00s/it]Running generate_until requests:  90%|████████▉ | 269/300 [34:10<02:30,  4.84s/it]Running generate_until requests:  90%|█████████ | 270/300 [34:21<03:18,  6.62s/it]Running generate_until requests:  90%|█████████ | 271/300 [34:26<02:58,  6.14s/it]Running generate_until requests:  91%|█████████ | 272/300 [34:33<03:03,  6.55s/it]Running generate_until requests:  91%|█████████ | 273/300 [34:37<02:35,  5.76s/it]Running generate_until requests:  91%|█████████▏| 274/300 [34:43<02:27,  5.67s/it]Running generate_until requests:  92%|█████████▏| 275/300 [34:47<02:09,  5.16s/it]Running generate_until requests:  92%|█████████▏| 276/300 [34:59<02:54,  7.26s/it]Running generate_until requests:  92%|█████████▏| 277/300 [35:03<02:27,  6.39s/it]Running generate_until requests:  93%|█████████▎| 278/300 [35:07<02:03,  5.63s/it]Running generate_until requests:  93%|█████████▎| 279/300 [35:11<01:50,  5.26s/it]Running generate_until requests:  93%|█████████▎| 280/300 [35:16<01:38,  4.94s/it]Running generate_until requests:  94%|█████████▎| 281/300 [35:21<01:35,  5.01s/it]Running generate_until requests:  94%|█████████▍| 282/300 [35:26<01:33,  5.20s/it]Running generate_until requests:  94%|█████████▍| 283/300 [35:30<01:21,  4.79s/it]Running generate_until requests:  95%|█████████▍| 284/300 [35:38<01:29,  5.61s/it]Running generate_until requests:  95%|█████████▌| 285/300 [35:43<01:20,  5.40s/it]Running generate_until requests:  95%|█████████▌| 286/300 [35:48<01:13,  5.25s/it]Running generate_until requests:  96%|█████████▌| 287/300 [35:50<00:55,  4.29s/it]Running generate_until requests:  96%|█████████▌| 288/300 [35:56<00:58,  4.91s/it]Running generate_until requests:  96%|█████████▋| 289/300 [36:03<00:59,  5.44s/it]Running generate_until requests:  97%|█████████▋| 290/300 [36:07<00:51,  5.15s/it]Running generate_until requests:  97%|█████████▋| 291/300 [36:14<00:50,  5.56s/it]Running generate_until requests:  97%|█████████▋| 292/300 [36:17<00:38,  4.82s/it]Running generate_until requests:  98%|█████████▊| 293/300 [36:24<00:38,  5.55s/it]Running generate_until requests:  98%|█████████▊| 294/300 [36:31<00:35,  5.95s/it]Running generate_until requests:  98%|█████████▊| 295/300 [36:37<00:29,  5.97s/it]Running generate_until requests:  99%|█████████▊| 296/300 [36:56<00:39,  9.97s/it]Running generate_until requests:  99%|█████████▉| 297/300 [37:00<00:24,  8.17s/it]Running generate_until requests:  99%|█████████▉| 298/300 [37:06<00:14,  7.38s/it]Running generate_until requests: 100%|█████████▉| 299/300 [37:12<00:07,  7.13s/it]Running generate_until requests: 100%|██████████| 300/300 [37:16<00:00,  6.21s/it]Running generate_until requests: 100%|██████████| 300/300 [37:16<00:00,  7.46s/it]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2025-03-31:18:45:32,501 WARNING  [huggingface.py:122] `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
2025-03-31:18:45:33,204 WARNING  [huggingface.py:329] Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
2025-03-31:18:45:33,205 INFO     [evaluator.py:152] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2025-03-31:18:45:33,205 INFO     [evaluator.py:203] Using pre-initialized model
2025-03-31:18:45:45,504 WARNING  [evaluator.py:251] Overwriting default num_fewshot of gsm8k from 5 to 10
2025-03-31:18:45:45,504 INFO     [evaluator.py:261] Setting fewshot random generator seed to 1234
2025-03-31:18:45:45,507 INFO     [task.py:411] Building contexts for gsm8k on rank 0...
finish_task gsm8k
|Tasks|Version|     Filter     |n-shot|  Metric   |   |Value |   |Stderr|
|-----|------:|----------------|-----:|-----------|---|-----:|---|-----:|
|gsm8k|      3|flexible-extract|     5|exact_match|↑  |0.3767|±  |0.0280|
|     |       |strict-match    |     5|exact_match|↑  |0.3633|±  |0.0278|

========================================
end : sp_config:  (0.5, 0.5, 0.0, 0) num_shot:  5
results
|Tasks|Version|     Filter     |n-shot|  Metric   |   |Value |   |Stderr|
|-----|------:|----------------|-----:|-----------|---|-----:|---|-----:|
|gsm8k|      3|flexible-extract|     5|exact_match|↑  |0.3767|±  |0.0280|
|     |       |strict-match    |     5|exact_match|↑  |0.3633|±  |0.0278|

========================================
begin : sp_config:  (0.5, 0.5, 0.0, 0) num_shot:  10
Init Reset
Set sparsity: attn 0.5, mlp 0.5, w 0.0
Set pre-prediction: 0
set_sparsity_threshold
threshold_path /data/wzw/wzw/BitDistiller-Q4_0/data/threshold/Meta-Llama-3-8B/sparse-0.5.json
sparsity_strategy :  Static
sparsity_strategy:  Static
  0%|          | 0/300 [00:00<?, ?it/s]  3%|▎         | 8/300 [00:00<00:03, 75.14it/s]  7%|▋         | 20/300 [00:00<00:02, 96.86it/s] 11%|█         | 32/300 [00:00<00:02, 104.11it/s] 15%|█▍        | 44/300 [00:00<00:02, 107.81it/s] 18%|█▊        | 55/300 [00:00<00:02, 107.76it/s] 22%|██▏       | 67/300 [00:00<00:02, 109.26it/s] 26%|██▋       | 79/300 [00:00<00:02, 110.23it/s] 30%|███       | 91/300 [00:00<00:01, 111.28it/s] 34%|███▍      | 103/300 [00:00<00:01, 111.10it/s] 38%|███▊      | 115/300 [00:01<00:01, 111.63it/s] 42%|████▏     | 127/300 [00:01<00:01, 112.03it/s] 46%|████▋     | 139/300 [00:01<00:01, 112.15it/s] 51%|█████     | 153/300 [00:01<00:01, 119.76it/s] 57%|█████▋    | 171/300 [00:01<00:00, 137.24it/s] 63%|██████▎   | 189/300 [00:01<00:00, 148.26it/s] 69%|██████▉   | 207/300 [00:01<00:00, 157.26it/s] 75%|███████▌  | 226/300 [00:01<00:00, 164.45it/s] 82%|████████▏ | 245/300 [00:01<00:00, 169.75it/s] 88%|████████▊ | 263/300 [00:01<00:00, 172.62it/s] 94%|█████████▎| 281/300 [00:02<00:00, 174.67it/s]100%|█████████▉| 299/300 [00:02<00:00, 175.72it/s]100%|██████████| 300/300 [00:02<00:00, 136.50it/s]
2025-03-31:18:45:47,718 INFO     [evaluator.py:438] Running generate_until requests
Running generate_until requests:   0%|          | 0/300 [00:00<?, ?it/s]/home/donglinbai/miniconda3/envs/sparse/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/donglinbai/miniconda3/envs/sparse/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Running generate_until requests:   0%|          | 1/300 [00:17<1:29:08, 17.89s/it]Running generate_until requests:   1%|          | 2/300 [00:23<51:47, 10.43s/it]  Running generate_until requests:   1%|          | 3/300 [00:29<43:24,  8.77s/it]Running generate_until requests:   1%|▏         | 4/300 [00:35<36:38,  7.43s/it]Running generate_until requests:   2%|▏         | 5/300 [00:41<34:10,  6.95s/it]Running generate_until requests:   2%|▏         | 6/300 [00:45<29:17,  5.98s/it]Running generate_until requests:   2%|▏         | 7/300 [00:51<29:51,  6.12s/it]Running generate_until requests:   3%|▎         | 8/300 [00:57<28:47,  5.91s/it]Running generate_until requests:   3%|▎         | 9/300 [01:03<28:44,  5.93s/it]Running generate_until requests:   3%|▎         | 10/300 [01:20<45:01,  9.32s/it]Running generate_until requests:   4%|▎         | 11/300 [01:39<59:47, 12.41s/it]Running generate_until requests:   4%|▍         | 12/300 [01:44<48:12, 10.04s/it]Running generate_until requests:   4%|▍         | 13/300 [01:47<38:40,  8.09s/it]Running generate_until requests:   5%|▍         | 14/300 [01:57<41:29,  8.70s/it]Running generate_until requests:   5%|▌         | 15/300 [02:02<35:08,  7.40s/it]Running generate_until requests:   5%|▌         | 16/300 [02:08<33:10,  7.01s/it]Running generate_until requests:   6%|▌         | 17/300 [02:14<32:07,  6.81s/it]Running generate_until requests:   6%|▌         | 18/300 [02:28<41:22,  8.80s/it]Running generate_until requests:   6%|▋         | 19/300 [02:30<32:22,  6.91s/it]Running generate_until requests:   7%|▋         | 20/300 [02:40<36:33,  7.83s/it]Running generate_until requests:   7%|▋         | 21/300 [02:43<29:05,  6.25s/it]Running generate_until requests:   7%|▋         | 22/300 [03:02<47:10, 10.18s/it]Running generate_until requests:   8%|▊         | 23/300 [03:09<42:24,  9.19s/it]Running generate_until requests:   8%|▊         | 24/300 [03:17<40:04,  8.71s/it]Running generate_until requests:   8%|▊         | 25/300 [03:21<34:08,  7.45s/it]Running generate_until requests:   9%|▊         | 26/300 [03:35<43:17,  9.48s/it]Running generate_until requests:   9%|▉         | 27/300 [03:39<34:44,  7.63s/it]Running generate_until requests:   9%|▉         | 28/300 [03:41<27:56,  6.16s/it]Running generate_until requests:  10%|▉         | 29/300 [04:01<45:41, 10.12s/it]Running generate_until requests:  10%|█         | 30/300 [04:05<37:02,  8.23s/it]Running generate_until requests:  10%|█         | 31/300 [04:09<32:12,  7.18s/it]Running generate_until requests:  11%|█         | 32/300 [04:17<33:12,  7.44s/it]Running generate_until requests:  11%|█         | 33/300 [04:37<48:55, 10.99s/it]Running generate_until requests:  11%|█▏        | 34/300 [04:44<43:29,  9.81s/it]Running generate_until requests:  12%|█▏        | 35/300 [04:49<37:36,  8.51s/it]Running generate_until requests:  12%|█▏        | 36/300 [04:56<35:26,  8.05s/it]Running generate_until requests:  12%|█▏        | 37/300 [05:03<34:16,  7.82s/it]Running generate_until requests:  13%|█▎        | 38/300 [05:09<31:27,  7.20s/it]Running generate_until requests:  13%|█▎        | 39/300 [05:13<26:55,  6.19s/it]Running generate_until requests:  13%|█▎        | 40/300 [05:17<24:15,  5.60s/it]Running generate_until requests:  14%|█▎        | 41/300 [05:23<24:44,  5.73s/it]Running generate_until requests:  14%|█▍        | 42/300 [05:35<32:24,  7.54s/it]Running generate_until requests:  14%|█▍        | 43/300 [05:49<40:22,  9.42s/it]Running generate_until requests:  15%|█▍        | 44/300 [05:56<37:04,  8.69s/it]Running generate_until requests:  15%|█▌        | 45/300 [06:15<50:30, 11.89s/it]Running generate_until requests:  15%|█▌        | 46/300 [06:25<47:33, 11.23s/it]Running generate_until requests:  16%|█▌        | 47/300 [06:31<41:17,  9.79s/it]Running generate_until requests:  16%|█▌        | 48/300 [06:42<41:46,  9.95s/it]Running generate_until requests:  16%|█▋        | 49/300 [06:47<35:51,  8.57s/it]Running generate_until requests:  17%|█▋        | 50/300 [06:54<34:12,  8.21s/it]Running generate_until requests:  17%|█▋        | 51/300 [06:56<26:14,  6.32s/it]Running generate_until requests:  17%|█▋        | 52/300 [07:06<30:29,  7.38s/it]Running generate_until requests:  18%|█▊        | 53/300 [07:13<29:39,  7.21s/it]Running generate_until requests:  18%|█▊        | 54/300 [07:32<44:36, 10.88s/it]Running generate_until requests:  18%|█▊        | 55/300 [07:47<49:14, 12.06s/it]Running generate_until requests:  19%|█▊        | 56/300 [07:54<43:01, 10.58s/it]Running generate_until requests:  19%|█▉        | 57/300 [07:58<34:58,  8.63s/it]Running generate_until requests:  19%|█▉        | 58/300 [08:02<28:51,  7.16s/it]Running generate_until requests:  20%|█▉        | 59/300 [08:10<29:03,  7.23s/it]Running generate_until requests:  20%|██        | 60/300 [08:15<26:35,  6.65s/it]Running generate_until requests:  20%|██        | 61/300 [08:19<23:41,  5.95s/it]Running generate_until requests:  21%|██        | 62/300 [08:26<24:27,  6.17s/it]Running generate_until requests:  21%|██        | 63/300 [08:31<23:24,  5.93s/it]Running generate_until requests:  21%|██▏       | 64/300 [08:40<26:52,  6.83s/it]Running generate_until requests:  22%|██▏       | 65/300 [08:48<27:57,  7.14s/it]Running generate_until requests:  22%|██▏       | 66/300 [08:58<30:40,  7.87s/it]Running generate_until requests:  22%|██▏       | 67/300 [09:13<39:46, 10.24s/it]Running generate_until requests:  23%|██▎       | 68/300 [09:21<36:32,  9.45s/it]Running generate_until requests:  23%|██▎       | 69/300 [09:26<31:02,  8.06s/it]Running generate_until requests:  23%|██▎       | 70/300 [09:37<34:52,  9.10s/it]Running generate_until requests:  24%|██▎       | 71/300 [09:46<34:05,  8.93s/it]Running generate_until requests:  24%|██▍       | 72/300 [10:05<45:45, 12.04s/it]Running generate_until requests:  24%|██▍       | 73/300 [10:13<41:07, 10.87s/it]Running generate_until requests:  25%|██▍       | 74/300 [10:27<43:51, 11.64s/it]Running generate_until requests:  25%|██▌       | 75/300 [10:32<36:35,  9.76s/it]Running generate_until requests:  25%|██▌       | 76/300 [10:40<34:05,  9.13s/it]Running generate_until requests:  26%|██▌       | 77/300 [10:47<32:12,  8.66s/it]Running generate_until requests:  26%|██▌       | 78/300 [11:02<39:05, 10.57s/it]Running generate_until requests:  26%|██▋       | 79/300 [11:07<32:49,  8.91s/it]Running generate_until requests:  27%|██▋       | 80/300 [11:13<29:09,  7.95s/it]Running generate_until requests:  27%|██▋       | 81/300 [11:23<31:05,  8.52s/it]Running generate_until requests:  27%|██▋       | 82/300 [11:29<28:08,  7.74s/it]Running generate_until requests:  28%|██▊       | 83/300 [11:40<31:21,  8.67s/it]Running generate_until requests:  28%|██▊       | 84/300 [11:43<25:35,  7.11s/it]Running generate_until requests:  28%|██▊       | 85/300 [11:48<23:14,  6.49s/it]Running generate_until requests:  29%|██▊       | 86/300 [11:59<27:41,  7.76s/it]Running generate_until requests:  29%|██▉       | 87/300 [12:03<23:57,  6.75s/it]Running generate_until requests:  29%|██▉       | 88/300 [12:13<26:54,  7.62s/it]Running generate_until requests:  30%|██▉       | 89/300 [12:19<24:53,  7.08s/it]Running generate_until requests:  30%|███       | 90/300 [12:28<27:14,  7.78s/it]Running generate_until requests:  30%|███       | 91/300 [12:34<24:36,  7.06s/it]Running generate_until requests:  31%|███       | 92/300 [12:43<27:04,  7.81s/it]Running generate_until requests:  31%|███       | 93/300 [12:45<21:04,  6.11s/it]Running generate_until requests:  31%|███▏      | 94/300 [12:51<20:26,  5.95s/it]Running generate_until requests:  32%|███▏      | 95/300 [12:57<20:57,  6.14s/it]Running generate_until requests:  32%|███▏      | 96/300 [13:04<21:20,  6.28s/it]Running generate_until requests:  32%|███▏      | 97/300 [13:09<19:34,  5.79s/it]Running generate_until requests:  33%|███▎      | 98/300 [13:20<25:03,  7.44s/it]Running generate_until requests:  33%|███▎      | 99/300 [13:30<27:37,  8.25s/it]Running generate_until requests:  33%|███▎      | 100/300 [13:36<25:37,  7.69s/it]Running generate_until requests:  34%|███▎      | 101/300 [13:47<27:56,  8.42s/it]Running generate_until requests:  34%|███▍      | 102/300 [13:55<27:52,  8.44s/it]Running generate_until requests:  34%|███▍      | 103/300 [14:14<38:22, 11.69s/it]Running generate_until requests:  35%|███▍      | 104/300 [14:23<35:13, 10.78s/it]Running generate_until requests:  35%|███▌      | 105/300 [14:31<32:07,  9.89s/it]Running generate_until requests:  35%|███▌      | 106/300 [14:42<33:13, 10.27s/it]Running generate_until requests:  36%|███▌      | 107/300 [14:47<27:53,  8.67s/it]Running generate_until requests:  36%|███▌      | 108/300 [15:06<37:56, 11.86s/it]Running generate_until requests:  36%|███▋      | 109/300 [15:12<31:35,  9.93s/it]Running generate_until requests:  37%|███▋      | 110/300 [15:22<31:46, 10.03s/it]Running generate_until requests:  37%|███▋      | 111/300 [15:29<28:35,  9.07s/it]Running generate_until requests:  37%|███▋      | 112/300 [15:35<25:36,  8.17s/it]Running generate_until requests:  38%|███▊      | 113/300 [15:39<21:32,  6.91s/it]Running generate_until requests:  38%|███▊      | 114/300 [15:44<19:51,  6.41s/it]Running generate_until requests:  38%|███▊      | 115/300 [15:52<21:20,  6.92s/it]Running generate_until requests:  39%|███▊      | 116/300 [16:05<26:14,  8.56s/it]Running generate_until requests:  39%|███▉      | 117/300 [16:14<27:14,  8.93s/it]Running generate_until requests:  39%|███▉      | 118/300 [16:25<28:24,  9.36s/it]Running generate_until requests:  40%|███▉      | 119/300 [16:35<29:10,  9.67s/it]Running generate_until requests:  40%|████      | 120/300 [16:54<37:38, 12.55s/it]Running generate_until requests:  40%|████      | 121/300 [17:00<30:59, 10.39s/it]Running generate_until requests:  41%|████      | 122/300 [17:07<28:09,  9.49s/it]Running generate_until requests:  41%|████      | 123/300 [17:17<28:03,  9.51s/it]Running generate_until requests:  41%|████▏     | 124/300 [17:36<36:37, 12.49s/it]Running generate_until requests:  42%|████▏     | 125/300 [17:45<33:03, 11.33s/it]Running generate_until requests:  42%|████▏     | 126/300 [17:56<32:45, 11.30s/it]Running generate_until requests:  42%|████▏     | 127/300 [17:58<24:39,  8.55s/it]Running generate_until requests:  43%|████▎     | 128/300 [18:03<21:03,  7.35s/it]Running generate_until requests:  43%|████▎     | 129/300 [18:08<19:30,  6.84s/it]Running generate_until requests:  43%|████▎     | 130/300 [18:28<29:56, 10.57s/it]Running generate_until requests:  44%|████▎     | 131/300 [18:44<34:39, 12.30s/it]Running generate_until requests:  44%|████▍     | 132/300 [18:47<26:57,  9.63s/it]Running generate_until requests:  44%|████▍     | 133/300 [18:57<27:14,  9.79s/it]Running generate_until requests:  45%|████▍     | 134/300 [19:03<23:54,  8.64s/it]Running generate_until requests:  45%|████▌     | 135/300 [19:21<31:12, 11.35s/it]Running generate_until requests:  45%|████▌     | 136/300 [19:32<30:58, 11.33s/it]Running generate_until requests:  46%|████▌     | 137/300 [19:39<27:09, 10.00s/it]Running generate_until requests:  46%|████▌     | 138/300 [19:46<24:05,  8.92s/it]Running generate_until requests:  46%|████▋     | 139/300 [19:52<21:39,  8.07s/it]Running generate_until requests:  47%|████▋     | 140/300 [19:57<19:15,  7.22s/it]Running generate_until requests:  47%|████▋     | 141/300 [20:00<15:50,  5.98s/it]Running generate_until requests:  47%|████▋     | 142/300 [20:03<13:38,  5.18s/it]Running generate_until requests:  48%|████▊     | 143/300 [20:11<15:15,  5.83s/it]Running generate_until requests:  48%|████▊     | 144/300 [20:16<14:34,  5.61s/it]Running generate_until requests:  48%|████▊     | 145/300 [20:21<14:08,  5.47s/it]Running generate_until requests:  49%|████▊     | 146/300 [20:29<16:02,  6.25s/it]Running generate_until requests:  49%|████▉     | 147/300 [20:33<13:54,  5.46s/it]Running generate_until requests:  49%|████▉     | 148/300 [20:43<17:33,  6.93s/it]Running generate_until requests:  50%|████▉     | 149/300 [21:02<26:43, 10.62s/it]Running generate_until requests:  50%|█████     | 150/300 [21:16<29:03, 11.62s/it]Running generate_until requests:  50%|█████     | 151/300 [21:25<26:47, 10.79s/it]Running generate_until requests:  51%|█████     | 152/300 [21:29<21:49,  8.85s/it]Running generate_until requests:  51%|█████     | 153/300 [21:34<18:43,  7.64s/it]Running generate_until requests:  51%|█████▏    | 154/300 [21:43<19:22,  7.96s/it]Running generate_until requests:  52%|█████▏    | 155/300 [21:50<18:23,  7.61s/it]Running generate_until requests:  52%|█████▏    | 156/300 [21:55<16:30,  6.88s/it]Running generate_until requests:  52%|█████▏    | 157/300 [22:00<15:16,  6.41s/it]Running generate_until requests:  53%|█████▎    | 158/300 [22:07<15:27,  6.53s/it]Running generate_until requests:  53%|█████▎    | 159/300 [22:14<15:54,  6.77s/it]Running generate_until requests:  53%|█████▎    | 160/300 [22:24<17:54,  7.68s/it]Running generate_until requests:  54%|█████▎    | 161/300 [22:27<14:45,  6.37s/it]Running generate_until requests:  54%|█████▍    | 162/300 [22:39<17:56,  7.80s/it]Running generate_until requests:  54%|█████▍    | 163/300 [22:45<16:43,  7.32s/it]Running generate_until requests:  55%|█████▍    | 164/300 [22:50<15:28,  6.83s/it]Running generate_until requests:  55%|█████▌    | 165/300 [23:01<17:36,  7.83s/it]Running generate_until requests:  55%|█████▌    | 166/300 [23:05<15:24,  6.90s/it]Running generate_until requests:  56%|█████▌    | 167/300 [23:12<15:13,  6.87s/it]Running generate_until requests:  56%|█████▌    | 168/300 [23:19<15:17,  6.95s/it]Running generate_until requests:  56%|█████▋    | 169/300 [23:31<18:25,  8.44s/it]Running generate_until requests:  57%|█████▋    | 170/300 [23:37<16:50,  7.77s/it]Running generate_until requests:  57%|█████▋    | 171/300 [23:40<13:27,  6.26s/it]Running generate_until requests:  57%|█████▋    | 172/300 [23:46<12:47,  5.99s/it]Running generate_until requests:  58%|█████▊    | 173/300 [23:51<12:11,  5.76s/it]Running generate_until requests:  58%|█████▊    | 174/300 [23:55<11:09,  5.31s/it]Running generate_until requests:  58%|█████▊    | 175/300 [24:06<14:22,  6.90s/it]Running generate_until requests:  59%|█████▊    | 176/300 [24:11<13:35,  6.58s/it]Running generate_until requests:  59%|█████▉    | 177/300 [24:31<21:20, 10.41s/it]Running generate_until requests:  59%|█████▉    | 178/300 [24:35<17:09,  8.44s/it]Running generate_until requests:  60%|█████▉    | 179/300 [24:41<15:35,  7.73s/it]Running generate_until requests:  60%|██████    | 180/300 [24:43<12:07,  6.06s/it]Running generate_until requests:  60%|██████    | 181/300 [24:48<11:38,  5.87s/it]Running generate_until requests:  61%|██████    | 182/300 [24:55<12:03,  6.13s/it]Running generate_until requests:  61%|██████    | 183/300 [25:01<12:05,  6.20s/it]Running generate_until requests:  61%|██████▏   | 184/300 [25:09<13:02,  6.75s/it]Running generate_until requests:  62%|██████▏   | 185/300 [25:18<13:57,  7.28s/it]Running generate_until requests:  62%|██████▏   | 186/300 [25:20<11:07,  5.86s/it]Running generate_until requests:  62%|██████▏   | 187/300 [25:26<11:04,  5.88s/it]Running generate_until requests:  63%|██████▎   | 188/300 [25:30<09:46,  5.24s/it]Running generate_until requests:  63%|██████▎   | 189/300 [25:37<10:34,  5.72s/it]Running generate_until requests:  63%|██████▎   | 190/300 [25:42<10:00,  5.46s/it]Running generate_until requests:  64%|██████▎   | 191/300 [25:53<13:12,  7.27s/it]Running generate_until requests:  64%|██████▍   | 192/300 [25:56<10:46,  5.99s/it]Running generate_until requests:  64%|██████▍   | 193/300 [26:02<10:27,  5.87s/it]Running generate_until requests:  65%|██████▍   | 194/300 [26:12<12:47,  7.24s/it]Running generate_until requests:  65%|██████▌   | 195/300 [26:32<18:55, 10.82s/it]Running generate_until requests:  65%|██████▌   | 196/300 [26:41<18:09, 10.47s/it]Running generate_until requests:  66%|██████▌   | 197/300 [26:47<15:41,  9.14s/it]Running generate_until requests:  66%|██████▌   | 198/300 [27:00<17:29, 10.29s/it]Running generate_until requests:  66%|██████▋   | 199/300 [27:04<14:00,  8.32s/it]Running generate_until requests:  67%|██████▋   | 200/300 [27:11<13:13,  7.94s/it]Running generate_until requests:  67%|██████▋   | 201/300 [27:30<18:41, 11.33s/it]Running generate_until requests:  67%|██████▋   | 202/300 [27:34<14:58,  9.17s/it]Running generate_until requests:  68%|██████▊   | 203/300 [27:37<11:37,  7.19s/it]Running generate_until requests:  68%|██████▊   | 204/300 [27:42<10:23,  6.49s/it]Running generate_until requests:  68%|██████▊   | 205/300 [27:47<09:48,  6.20s/it]Running generate_until requests:  69%|██████▊   | 206/300 [27:52<08:59,  5.74s/it]Running generate_until requests:  69%|██████▉   | 207/300 [27:57<08:38,  5.57s/it]Running generate_until requests:  69%|██████▉   | 208/300 [28:04<09:10,  5.99s/it]Running generate_until requests:  70%|██████▉   | 209/300 [28:07<07:28,  4.93s/it]Running generate_until requests:  70%|███████   | 210/300 [28:12<07:40,  5.12s/it]Running generate_until requests:  70%|███████   | 211/300 [28:20<08:43,  5.89s/it]Running generate_until requests:  71%|███████   | 212/300 [28:24<08:06,  5.52s/it]Running generate_until requests:  71%|███████   | 213/300 [28:36<10:38,  7.34s/it]Running generate_until requests:  71%|███████▏  | 214/300 [28:46<11:43,  8.18s/it]Running generate_until requests:  72%|███████▏  | 215/300 [28:51<10:18,  7.28s/it]Running generate_until requests:  72%|███████▏  | 216/300 [28:59<10:17,  7.36s/it]Running generate_until requests:  72%|███████▏  | 217/300 [29:03<08:39,  6.26s/it]Running generate_until requests:  73%|███████▎  | 218/300 [29:06<07:30,  5.50s/it]Running generate_until requests:  73%|███████▎  | 219/300 [29:13<07:54,  5.86s/it]Running generate_until requests:  73%|███████▎  | 220/300 [29:18<07:28,  5.61s/it]Running generate_until requests:  74%|███████▎  | 221/300 [29:27<08:43,  6.63s/it]Running generate_until requests:  74%|███████▍  | 222/300 [29:38<10:28,  8.05s/it]Running generate_until requests:  74%|███████▍  | 223/300 [29:44<09:27,  7.37s/it]Running generate_until requests:  75%|███████▍  | 224/300 [29:50<08:33,  6.76s/it]Running generate_until requests:  75%|███████▌  | 225/300 [29:57<08:33,  6.84s/it]Running generate_until requests:  75%|███████▌  | 226/300 [30:03<08:24,  6.82s/it]Running generate_until requests:  76%|███████▌  | 227/300 [30:08<07:36,  6.25s/it]Running generate_until requests:  76%|███████▌  | 228/300 [30:15<07:33,  6.30s/it]Running generate_until requests:  76%|███████▋  | 229/300 [30:23<08:12,  6.93s/it]Running generate_until requests:  77%|███████▋  | 230/300 [30:27<07:01,  6.03s/it]Running generate_until requests:  77%|███████▋  | 231/300 [30:30<05:46,  5.03s/it]Running generate_until requests:  77%|███████▋  | 232/300 [30:45<09:18,  8.21s/it]Running generate_until requests:  78%|███████▊  | 233/300 [30:53<08:54,  7.98s/it]Running generate_until requests:  78%|███████▊  | 234/300 [30:58<07:52,  7.16s/it]Running generate_until requests:  78%|███████▊  | 235/300 [31:10<09:26,  8.71s/it]Running generate_until requests:  79%|███████▊  | 236/300 [31:17<08:32,  8.01s/it]Running generate_until requests:  79%|███████▉  | 237/300 [31:36<11:55, 11.35s/it]Running generate_until requests:  79%|███████▉  | 238/300 [31:41<09:41,  9.37s/it]Running generate_until requests:  80%|███████▉  | 239/300 [31:53<10:28, 10.31s/it]Running generate_until requests:  80%|████████  | 240/300 [31:57<08:21,  8.35s/it]Running generate_until requests:  80%|████████  | 241/300 [32:01<06:57,  7.07s/it]Running generate_until requests:  81%|████████  | 242/300 [32:14<08:39,  8.95s/it]Running generate_until requests:  81%|████████  | 243/300 [32:24<08:48,  9.26s/it]Running generate_until requests:  81%|████████▏ | 244/300 [32:30<07:29,  8.03s/it]Running generate_until requests:  82%|████████▏ | 245/300 [32:39<07:48,  8.51s/it]Running generate_until requests:  82%|████████▏ | 246/300 [32:49<07:55,  8.80s/it]Running generate_until requests:  82%|████████▏ | 247/300 [32:56<07:24,  8.39s/it]Running generate_until requests:  83%|████████▎ | 248/300 [33:06<07:39,  8.83s/it]Running generate_until requests:  83%|████████▎ | 249/300 [33:11<06:35,  7.75s/it]Running generate_until requests:  83%|████████▎ | 250/300 [33:20<06:48,  8.16s/it]Running generate_until requests:  84%|████████▎ | 251/300 [33:32<07:27,  9.13s/it]Running generate_until requests:  84%|████████▍ | 252/300 [33:40<07:10,  8.98s/it]Running generate_until requests:  84%|████████▍ | 253/300 [33:46<06:15,  7.99s/it]Running generate_until requests:  85%|████████▍ | 254/300 [33:52<05:37,  7.35s/it]Running generate_until requests:  85%|████████▌ | 255/300 [33:54<04:20,  5.79s/it]Running generate_until requests:  85%|████████▌ | 256/300 [34:01<04:30,  6.15s/it]Running generate_until requests:  86%|████████▌ | 257/300 [34:06<04:05,  5.71s/it]Running generate_until requests:  86%|████████▌ | 258/300 [34:11<03:53,  5.56s/it]Running generate_until requests:  86%|████████▋ | 259/300 [34:14<03:24,  4.99s/it]Running generate_until requests:  87%|████████▋ | 260/300 [34:21<03:34,  5.37s/it]Running generate_until requests:  87%|████████▋ | 261/300 [34:27<03:38,  5.61s/it]Running generate_until requests:  87%|████████▋ | 262/300 [34:32<03:23,  5.35s/it]Running generate_until requests:  88%|████████▊ | 263/300 [34:34<02:47,  4.53s/it]Running generate_until requests:  88%|████████▊ | 264/300 [34:39<02:44,  4.56s/it]Running generate_until requests:  88%|████████▊ | 265/300 [34:44<02:43,  4.66s/it]Running generate_until requests:  89%|████████▊ | 266/300 [35:03<05:07,  9.04s/it]Running generate_until requests:  89%|████████▉ | 267/300 [35:10<04:32,  8.26s/it]Running generate_until requests:  89%|████████▉ | 268/300 [35:18<04:23,  8.24s/it]Running generate_until requests:  90%|████████▉ | 269/300 [35:32<05:10, 10.02s/it]Running generate_until requests:  90%|█████████ | 270/300 [35:40<04:41,  9.37s/it]Running generate_until requests:  90%|█████████ | 271/300 [35:42<03:32,  7.32s/it]Running generate_until requests:  91%|█████████ | 272/300 [35:48<03:11,  6.82s/it]Running generate_until requests:  91%|█████████ | 273/300 [36:06<04:34, 10.18s/it]Running generate_until requests:  91%|█████████▏| 274/300 [36:25<05:34, 12.88s/it]Running generate_until requests:  92%|█████████▏| 275/300 [36:30<04:22, 10.49s/it]Running generate_until requests:  92%|█████████▏| 276/300 [36:43<04:26, 11.11s/it]Running generate_until requests:  92%|█████████▏| 277/300 [36:49<03:40,  9.59s/it]Running generate_until requests:  93%|█████████▎| 278/300 [36:57<03:22,  9.22s/it]Running generate_until requests:  93%|█████████▎| 279/300 [37:04<03:02,  8.70s/it]Running generate_until requests:  93%|█████████▎| 280/300 [37:10<02:33,  7.67s/it]Running generate_until requests:  94%|█████████▎| 281/300 [37:17<02:25,  7.65s/it]Running generate_until requests:  94%|█████████▍| 282/300 [37:20<01:51,  6.18s/it]Running generate_until requests:  94%|█████████▍| 283/300 [37:26<01:45,  6.18s/it]Running generate_until requests:  95%|█████████▍| 284/300 [37:45<02:41, 10.07s/it]Running generate_until requests:  95%|█████████▌| 285/300 [37:53<02:19,  9.29s/it]Running generate_until requests:  95%|█████████▌| 286/300 [38:05<02:23, 10.25s/it]Running generate_until requests:  96%|█████████▌| 287/300 [38:14<02:05,  9.66s/it]Running generate_until requests:  96%|█████████▌| 288/300 [38:17<01:31,  7.64s/it]Running generate_until requests:  96%|█████████▋| 289/300 [38:23<01:20,  7.31s/it]Running generate_until requests:  97%|█████████▋| 290/300 [38:29<01:10,  7.02s/it]Running generate_until requests:  97%|█████████▋| 291/300 [38:37<01:05,  7.25s/it]Running generate_until requests:  97%|█████████▋| 292/300 [38:48<01:06,  8.32s/it]Running generate_until requests:  98%|█████████▊| 293/300 [38:52<00:48,  6.96s/it]Running generate_until requests:  98%|█████████▊| 294/300 [38:57<00:37,  6.29s/it]Running generate_until requests:  98%|█████████▊| 295/300 [39:05<00:34,  6.83s/it]Running generate_until requests:  99%|█████████▊| 296/300 [39:11<00:27,  6.76s/it]Running generate_until requests:  99%|█████████▉| 297/300 [39:15<00:17,  5.77s/it]Running generate_until requests:  99%|█████████▉| 298/300 [39:21<00:11,  5.87s/it]Running generate_until requests: 100%|█████████▉| 299/300 [39:27<00:05,  5.90s/it]Running generate_until requests: 100%|██████████| 300/300 [39:35<00:00,  6.66s/it]Running generate_until requests: 100%|██████████| 300/300 [39:35<00:00,  7.92s/it]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
finish_task gsm8k
|Tasks|Version|     Filter     |n-shot|  Metric   |   |Value|   |Stderr|
|-----|------:|----------------|-----:|-----------|---|----:|---|-----:|
|gsm8k|      3|flexible-extract|    10|exact_match|↑  | 0.33|±  |0.0272|
|     |       |strict-match    |    10|exact_match|↑  | 0.32|±  |0.0270|

========================================
end : sp_config:  (0.5, 0.5, 0.0, 0) num_shot:  10
results
|Tasks|Version|     Filter     |n-shot|  Metric   |   |Value|   |Stderr|
|-----|------:|----------------|-----:|-----------|---|----:|---|-----:|
|gsm8k|      3|flexible-extract|    10|exact_match|↑  | 0.33|±  |0.0272|
|     |       |strict-match    |    10|exact_match|↑  | 0.32|±  |0.0270|

========================================
tools/test_task.sh: line 19: d: command not found
